<%- include('../includes/head.ejs') %>
</head>

<body>
  <%- include('../includes/navigation.ejs') %>

  <main>
    <h1>Your Orders</h1>

    <% if (orders && orders.length > 0) { %> 
      <% orders.forEach(order => { %>
        <section class="order">
          <h2>Order #<%= order.id %> - Created: <%= order.createdAt.toDateString() %></h2>
          <ul class="no-style">
            <% order.products.forEach(product => { %>
              <li><%= product.title %> (Quantity: <%= product.orderItem.quantity %>)</li>  
            <% }) %>
          </ul>
          <p>
            <strong>Total:</strong> $
            <%= order.products.reduce((sum, p) => sum + p.price * p.orderItem.quantity, 0).toFixed(2) %>
          </p>
        </section>
      <% }) %>
    <% } else { %>
      <p>No orders found!</p>
    <% } %>
  </main>

  <%- include('../includes/end.ejs') %>
</body>
